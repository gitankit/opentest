<?php

/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
Class Question {
    
    public $id;
    public $question;
    public $options = array();
    public $answer;
    public $keyword;
    public $level;
    public $test; //Test ID for getting distinct question
    private $_db;
    
    public function __construct($question_id=NULL) {
        $this->_db = new Db();
        if ( isset($question_id) ) { $this->id = $question_id; }
        else { $this->id = NULL; }
    }
    
    public function get_question_details_by_test() {
        if (isset($this->test))
        {
            $query = "SELECT a.* FROM question a,quiz_details b  WHERE
                        a.id=b.question AND b.quiz=$this->test";
            $result = $this->_db->query($query);
            if ( $result && count($result) > 0 )
            {
                return $result;
            }
            else 
            {
                return FALSE;
            }
        }
        else
        {
            return FALSE;
        }
    }
    public function get_question_detail() {
        if ( isset($this->id) )
        {
            $query = "SELECT * FROM questions WHERE id=$this->id";
            $result = $this->_db->query($query);
            return $result;
        }
        else
        {
            return FALSE;
        }
    }
    
    public function get_details_by_keyword() {
        if ( isset ($this->keyword) )
        {
            $query = "SELECT * FROM questions WHERE keyword='$this->keyword'";
            $result = $this->_db->query($query);
            return $result;
        }
        else 
        {
            return FALSE;
        }
    }
    
    public function get_details_by_level() {
        if ( isset($this->level))
        {
        $query = "SELECT * FROM questions WHERE level=$this->level";
        $result = $this->_db->query($query);
        return $result;
        }
        else
        {
            return FALSE;
        }
        
    }
    public function get_details_by_keyword_distinct() {
        if ( isset ($this->keyword) && isset($this->test))
        {
            $query = "SELECT * FROM questions WHERE id NOT IN 
                      (SELECT question FROM quiz_detail WHERE 
                        quiz=$this->test) AND keyword='$this->keyword'";
            $result = $this->_db->query($query);
            return $result;
        }
        else 
        {
            return FALSE;
        }
    }
    
    public function get_details_by_level_distinct() {
        if ( isset($this->level) && isset($this->test))
        {
        $query = "SELECT * FROM questions WHERE id NOT IN 
                  (SELECT question FROM quiz_detail WHERE quiz=$this->test)
                    AND level=$this->level";
        $result = $this->_db->query($query);
        return $result;
        }
        else
        {
            return FALSE;
        }
    }
    
    public function get_keywords() {
        $query = "SELECT DISTINCT keyword FROM question";
        $result = $this->_db->query($query);
        return $result;
    }

    public function get_all_distinct_questions() {
    if ( isset($this->test))
    {
    $query = "SELECT * FROM questions WHERE id NOT IN 
              (SELECT question FROM quiz_details WHERE quiz=$this->test)";
    $result = $this->_db->query($query);
    return $result;
    }
    else
    {
        return FALSE;
    }
}

}
?>
