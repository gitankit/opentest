<?php

/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/**
 * Description of User
 *
 * @author Ankit
 */
class User {
    //put your code here

    private $_db;
    private $_id;
    public $type;// = 'NULL';
    public function __construct($username) {
        $this->_db = new Db();
        $this->_id = $username;
        $this->get_type();
    }
    
    public function authenticate($username,$password) {
        $res = $this->_db->query("SELECT * FROM `users` WHERE 
                                    id=$username and 
                                    password='$password'");   
        if ( $_db->affected_rows == 1 )
        {
            return 0;
        }
        else 
        {
            return 1;
        }
    }
    
    protected function get_type () {
        $result = $this->_db->query("SELECT type 
                                         FROM `users` 
                                         WHERE `id`=$this->_id");
        //$this->type = $this->_db->result[0]['type'];
        //echo $this->_db->affected_rows;
        //print_r($this->type[0]['type']);
        $this->type  = $result[0]['type'];
    }
    
    public function get_scheduled_tests () {
        $result = $this->_db->query("SELECT id,name,
            DATE_FORMAT(date_created,'%a %e %M, %Y %l:%i %p') as date_created,
                            no_of_questions,time_limit
                            FROM quiz 
                            WHERE id IN 
                                ( SELECT quiz from `result` 
                                    WHERE attendee=$this->_id
                                    AND attempt_date IS NULL)");
    
        //echo "<pre>";print_r($this->_db->result);echo "</pre>";
        //print_r($this->_db->affected_rows);exit(0);
        return $result;
    
    }
        public function get_attempted_tests () {
            $result = $this->_db->query("SELECT b.name,b.date_created,a.attempt_date,
                                a.score FROM `result` a, `quiz` b 
                                WHERE a.quiz=b.id 
                                 AND a.attempt_date IS NOT NULL
                                 AND a.attendee=$this->_id");
            return $result;
            
        }
}

?>
