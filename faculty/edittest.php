<?php
session_start();
require_once('faculty_functions.php');
require_once('../db.php');
if(isset($_POST['Submit']))
  {
    if(strlen($_POST['name'])>0)
     {
      if(strlen($_POST['time_limit'])>0)
       {
         if(strlen($_POST['max_marks'])>0)
          {
           if(strlen($_POST['pass_marks'])>0)
            {
              if(strlen($_POST['marks'])>0)
                {
                  if($_POST['max_marks']>=$_POST['pass_marks'])
                   {
                    if($_POST['marks']<=$_POST['pass_marks'])
                     {
                       if($_POST['negative_marks']<=$_POST['marks'])
                        {
                         $result=edit_test($connection,$_POST['quizid'],$_POST['name'],$_POST['time_limit'],$_POST['max_marks'],$_POST['pass_marks'],$_POST['negative_marks'],$_POST['marks']);
	                 if($result==0)
                          {
		           $message="Quiz Edited Successfully";
		          }
		         else
		          {
		           $error="Editing Failed";
		          }
                       }
                      else
                        {
                         $error=$error." Negative Marks should be less than marks for each question";
                        }
                     }
                    else
                     {
                      $error=$error." Marks for each question should be less than Pass Marks.";
                     }
                   }
                  else
                   {
                    $error=$error." Pass Marks should be less than Maximum Marks.";
                   }
                 }
                else
                 {
                  $error=$error." Marks for each question cannot be null.";
                 }
               }
              else
               {
                $error=$error." Pass Marks cannot be null.";
               }
             }
            else
             {
              $error=$error." Maximum Marks cannot be null.";
             }
       }
      else
       {
        $error=$error." Attempt Time should not be null.";
       }
     }
    else
     {
      $error=$error." Name should not be null.";
     }
  }

/*if(isset($_POST['Submit']))
  {
      $result=edit_test($connection_orcl,$_POST['quizid'],$_POST['name'],$_POST['time_limit'],$_POST['max_marks'],$_POST['pass_marks'],$_POST['negative_marks'],$_POST['marks']);
	   if($result==0)
        {
		  $message="Quiz Edited Successfully";
		}
		else
		  {
		    $error="Editing Failed";
		  }
  }*/
  $sql="SELECT * FROM Quiz WHERE id=".$_POST['quizid'];
  $query=mysql_query($sql,$connection);
  $row=mysql_fetch_array($query,MYSQL_NUM);
  
  include('./header.php');
?>



<div id="wrapper">
<div class="form-container">
      <form  autocomplete="off"  enctype="multipart/form-data"  action="edittest.php" method="POST"  >

<?php if(isset($message)) { echo '<div  class="box green">'.$message.'</div>'; } ?>
<?php if(isset($error)) { echo '<div  class="box red">'.$error.'</div>'; } ?>

	<p class="legend"><strong>Note:</strong> Required fields are marked with an asterisk (<em>*</em>)</p>
	
	<fieldset>
		<legend>Quiz Details</legend>
			<div><label for="uname" >Name <em>*</em></label> <input id="uname" type="text" name="name" value="<?php echo $row[1] ?>"  /></div>
			<div><label for="email">Attempt Time (in minutes) <em>*</em></label> <input id="email" type="text" name="time_limit" value="<?php echo $row[3] ?>" size="10"/>
			</div>
	</fieldset>
	
	<fieldset>
		<legend>Marks Detail</legend>
			<div><label for="address1">Maximum Marks <em>*</em></label> <input id="address1" type="text" size="10" name="max_marks" value="<?php echo $row[2] ?>" /></div>
			<div><label for="address2">Pass Marks <em>*</em></label> <input id="address2" type="text" size="10" name="pass_marks" value="<?php echo $row[7] ?>" /></div>
			<div><label for="country" >Negative Marks </label> <input id="country" type="text"  name="negative_marks" value="<?php echo $row[9] ?>"  size="10" /></div>
			<div><label for="address2">Each Question <em>*</em></label> <input id="address2" type="text" size="10" name="marks" value="<?php echo $row[10] ?>" /></div>
	</fieldset>
	<div class="buttonrow">
		<input type="submit" name="Submit" value="Save Changes" class="button" />
                <input type="hidden" name="quizid" value="<?php echo $row[0] ?>"  />
	</div>
   </form>
  </div>
</div>


<hr>
<?php include('../footer.php') ?>
</div>	
</body>
</html>
